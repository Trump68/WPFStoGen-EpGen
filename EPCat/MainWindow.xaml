<Window
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:EPCat"
        xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid" xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol" xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors" xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core" xmlns:Serialization="clr-namespace:DevExpress.Xpf.LayoutControl.Serialization;assembly=DevExpress.Xpf.LayoutControl.v16.1" xmlns:dxca="http://schemas.devexpress.com/winfx/2008/xaml/carousel" x:Class="EPCat.MainWindow"
        mc:Ignorable="d"
        Title="MainWindow" Height="674.484" Width="1290.694" Closing="Window_Closing" Loaded="Window_Loaded">

    <Window.DataContext>
        <local:EpCatViewModel/>
    </Window.DataContext>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>

        <dx:DXTabControl Margin="0" SelectionChanged="TabPageChanged">
            <dx:DXTabItem Name="TabMain" Header="Main">

                <dxlc:LayoutControl Orientation="Vertical" Margin="0" Padding="0">
                    <dxlc:LayoutGroup>
                        <dxlc:LayoutGroup dx:ScrollViewerTouchBehavior.IsEnabled="True" Serialization:SerializableItem.TypeName="LayoutGroup">
                            <dxlc:LayoutItem HorizontalAlignment="Left">
                                <dx:SimpleButton x:Name="LoadBtn" Content="Load" Width="50" HorizontalAlignment="Left" Click="simpleButton_Click"/>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem HorizontalAlignment="Left" Margin="100,0,0,0">
                                <dx:SimpleButton x:Name="CollapseBtn" Content="Hide" Width="50" HorizontalAlignment="Left" Click="Collapse_Click"/>
                            </dxlc:LayoutItem>
                        </dxlc:LayoutGroup>
                        <dxlc:LayoutItem Margin="20,0,0,0" Width="50">
                            <dxe:CheckEdit x:Name="EditAllowed"  Content ="Edit"/>
                        </dxlc:LayoutItem>

                        <dxlc:LayoutItem Margin="0,0,0,0" Width="140">
                        <dxe:ListBoxEdit Name="rgCapsMode"  ShowBorder="True" EditValueChanged="SetCapsMode" SelectedIndex="0" >
                            <dxe:ListBoxEdit.StyleSettings><dxe:RadioListBoxEditStyleSettings /></dxe:ListBoxEdit.StyleSettings>
                                <dxe:ListBoxEdit.ItemsPanel><ItemsPanelTemplate><StackPanel Orientation="Horizontal" /></ItemsPanelTemplate></dxe:ListBoxEdit.ItemsPanel>
                                <dxe:ListBoxEdit.Items>
                                    <dxe:ListBoxEditItem Content="All" />
                                    <dxe:ListBoxEditItem Content="Parent"/>
                                </dxe:ListBoxEdit.Items>
                            </dxe:ListBoxEdit>
                        </dxlc:LayoutItem>
                        
                        <dxlc:LayoutItem Margin="0,0,0,0" Width="500">
                            <dxe:ListBoxEdit Name="rgCapsPassport"  ShowBorder="True" EditValueChanged="SetCurrentImagePassort" SelectedIndex="0" >
                                <dxe:ListBoxEdit.StyleSettings>
                                    <dxe:RadioListBoxEditStyleSettings />
                                </dxe:ListBoxEdit.StyleSettings>
                                <dxe:ListBoxEdit.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <StackPanel Orientation="Horizontal" />
                                    </ItemsPanelTemplate>
                                </dxe:ListBoxEdit.ItemsPanel>
                                <dxe:ListBoxEdit.Items>
                                    <dxe:ListBoxEditItem Content="Caps" />
                                    <dxe:ListBoxEditItem Content="Events"/>
                                    <dxe:ListBoxEditItem Content="Figures"/>
                                    <dxe:ListBoxEditItem Content="Parts"/>
                                    <dxe:ListBoxEditItem Content="Backg"/>
                                    <dxe:ListBoxEditItem Content="Compos"/>
                                </dxe:ListBoxEdit.Items>
                            </dxe:ListBoxEdit>
                        </dxlc:LayoutItem>
                        
                    </dxlc:LayoutGroup>
                    <dxlc:LayoutGroup>
                        <dxg:GridControl x:Name="GV" AutoGenerateColumns="None" EnableSmartColumnsGeneration="True" ItemsSource="{Binding FolderListView}" SelectedItem="{Binding CurrentFolder}" SelectionMode="Row">
                            <dxg:GridControl.View>
                                <dxg:TableView AllowConditionalFormattingMenu="True" AllowEditing="{Binding IsChecked, ElementName=EditAllowed}" AllowPerPixelScrolling="True" ShowAutoFilterRow="True" ShowTotalSummary="True" AutoWidth="True" ShowDataNavigator="False">
                                    <dxg:TableView.FormatConditions>
                                        <dxg:ColorScaleFormatCondition Expression="[VideoPresent] = True" FieldName="ItemPath" PredefinedFormatName="YellowGreenColorScale"/>
                                    </dxg:TableView.FormatConditions>
                                </dxg:TableView>
                            </dxg:GridControl.View>
                            <dxg:GridControl.TotalSummary>
                                <dxg:GridSummaryItem FieldName="Name" SummaryType="Count"/>
                                <dxg:GridSummaryItem SummaryType="Count" Alignment="Right"/>
                            </dxg:GridControl.TotalSummary>
                            <dxg:GridColumn FieldName="Name" IsSmart="True"/>
                            <dxg:GridColumn FieldName="AltTitle" IsSmart="True"/>
                            <dxg:GridColumn FieldName="Country" IsSmart="True"/>
                            <dxg:GridColumn FieldName="Year" IsSmart="True"/>
                            <dxg:GridColumn FieldName="Rated" IsSmart="True"/>
                            <dxg:GridColumn FieldName="Star" IsSmart="True"/>
                            <dxg:GridColumn FieldName="MyDescr" IsSmart="True"/>
                            <dxg:GridColumn FieldName="Director" IsSmart="True"/>
                            <dxg:GridColumn FieldName="Studio" IsSmart="True"/>
                            <dxg:GridColumn FieldName="IMDB" IsSmart="True"/>
                            <dxg:GridColumn FieldName="ItemPath" IsSmart="True"/>
                            <dxg:GridColumn FieldName="VideoPresent" IsSmart="True" Width="20" Header="."/>
                        </dxg:GridControl>
                        <dxlc:LayoutGroup  Name ="MainDetail" View="Group"  Orientation="Vertical">
                            <dxlc:LayoutItem Margin="0" Padding="0" ElementSpace="0" MinHeight="100" MaxHeight="300">
                                <Image Source="{Binding SelectedItem.Poster, ElementName=GV  }" Stretch="Uniform" />
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem  Margin="0" Padding="0" ElementSpace="0">
                                <ContentPresenter x:Name ="DetailView" Grid.Row="0" Grid.Column="1" Content="{Binding SelectedItem, ElementName=GV}" ContentTemplate="{StaticResource rowDetailTemplate}" HorizontalAlignment="Stretch"/>
                            </dxlc:LayoutItem>
                        </dxlc:LayoutGroup>
                    </dxlc:LayoutGroup>
                </dxlc:LayoutControl>
            </dx:DXTabItem>
            <dx:DXTabItem Name ="TabCaps" Header="Caps" Padding="10,0">

                <dxlc:FlowLayoutControl x:Name="layoutImages" ItemsSource="{Binding CurrentCaps}"
                              AllowItemMoving="False" 
                              AllowLayerSizing="True"
                              AllowMaximizedElementMoving="False"
                              AnimateScrolling ="False"
                              AnimateItemMaximization ="False"
                              AnimateItemMoving="False"
                              DragScrolling="False"
                              Background="Black" ShowLayerSeparators="True" Padding="0" ItemSpace="0" LayerSpace="0" Margin="0"  
                              
                              >
                    <dxlc:FlowLayoutControl.ItemTemplate>
                        <DataTemplate>
                            <dxlc:GroupBox Header="{Binding}" Content="{Binding}" Width="150" Height="150" Padding="0" 
                                 Margin="0,0,0,0"                                                 
                                 MaximizeElementVisibility="Visible"
                                 FontFamily="Segoe UI Light" FontSize="12" Cursor="Hand"                                             
                                 >
                               
                                <!--HeaderTemplate-->
                                <dxlc:GroupBox.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Margin="0" Height="10" FontFamily="Segoe UI Light" FontSize="9">
                                            <Run Text="Файл:" FontFamily="Segoe UI" />
                                            <Run Text="{Binding Id}" />
                                            <Run Text=": " />
                                            <Run Text="{Binding FileName}" />
                                        </TextBlock>
                                    </DataTemplate>
                                </dxlc:GroupBox.HeaderTemplate>
                                
                                <!--ContentTemplate-->
                                <dxlc:GroupBox.ContentTemplate >
                                    <DataTemplate >
                                        <Image Source="{Binding Thumb}" Stretch="Uniform"  HorizontalAlignment="Center" MouseLeftButtonUp="GroupBox_MouseLeftButtonUp"/>
                                    </DataTemplate>
                                </dxlc:GroupBox.ContentTemplate>
                                
                                <!--MaximizedContentTemplate-->
                                <dxlc:GroupBox.MaximizedContentTemplate>
                                    <DataTemplate>
                                        
                                        <dxlc:LayoutControl ItemSpace="0" Margin="0,0,0,0" Padding="0,0,0,0">

                                            <dxlc:LayoutGroup Background="White" Orientation="Vertical" HorizontalAlignment="Left" VerticalAlignment="Top" Margin ="0,0,0,0" Padding="0,0,0,0">
                                                    <dxlc:LayoutGroup View="Group" Header="Source" Orientation="Horizontal">

                                                    <dxlc:LayoutGroup View="Group" Header="Source" Orientation="Vertical">
                                                        <dxlc:LayoutGroup View="Group" Header="Source" Orientation="Horizontal">
                                                            <dxlc:LayoutItem Label=" ">
                                                                <TextBlock Text="{Binding Id}" />
                                                            </dxlc:LayoutItem>
                                                            <dxlc:LayoutItem Label="Parent:">
                                                                <dxe:SpinEdit Text="{Binding ParentId}" Width="50"/>
                                                            </dxlc:LayoutItem>
                                                        </dxlc:LayoutGroup>

                                                        <dxlc:LayoutItem Label="Name">
                                                            <dxe:TextEdit Text="{Binding Name}" Width="150" TextWrapping="Wrap"/>
                                                        </dxlc:LayoutItem>
                                                        <dxlc:LayoutItem Label="Descr">
                                                            <dxe:TextEdit Text="{Binding Description}" Width="150" TextWrapping="Wrap"/>
                                                        </dxlc:LayoutItem>
                                                        <dxlc:LayoutItem Label="Star">
                                                            <dxe:TextEdit Text="{Binding Star}" Width="150" TextWrapping="Wrap"/>
                                                        </dxlc:LayoutItem>
                                                    </dxlc:LayoutGroup>

                                                    <dxlc:LayoutItem Margin="0" Padding="0" VerticalAlignment="Stretch" ElementSpace="0">
                                                            <ContentPresenter x:Name ="DetailView" Grid.Row="0" Grid.Column="1" Content="{Binding}" ContentTemplate="{StaticResource rowDetailTemplate}" HorizontalAlignment="Stretch"/>
                                                        </dxlc:LayoutItem>
                                                    </dxlc:LayoutGroup>
                                                </dxlc:LayoutGroup>
                                                
                                            
                                            <Image Source="{Binding Picture}" Stretch="Uniform"  MouseLeftButtonUp="GroupBox_MouseLeftButtonUp"/>
                                            
                                        </dxlc:LayoutControl>
                                    </DataTemplate>
                                </dxlc:GroupBox.MaximizedContentTemplate>

                            </dxlc:GroupBox>
                        </DataTemplate>
                    </dxlc:FlowLayoutControl.ItemTemplate>
                </dxlc:FlowLayoutControl>
            </dx:DXTabItem>
        </dx:DXTabControl>


    </Grid>
</Window>
